<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>눈싸움</title>
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="shortcut icon" href="/favicon.ico">

  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes">
  <style>
    body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100dvh;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }
    #unity-canvas {
      background: #231F20;
      box-sizing: border-box;
      max-width: 450px;
      max-height: 1000px;
    }
  </style>
</head>
<body>
  <canvas id="unity-canvas" tabindex="-1"></canvas>
  <script src="Build/Build.loader.js"></script>
  <script>
    let unityInstance = null;

    function resizePage() {
      const canvas = document.getElementById("unity-canvas");
      const containerWidth = window.innerWidth;
      const containerHeight = window.innerHeight;


      const maxCanvasWidth = 1000;
      const maxCanvasHeight = 1000;

      let scale = Math.min(
        containerWidth / maxCanvasWidth,
        containerHeight / maxCanvasHeight,
        1 // 확대는 하지 않음
      );

      const width = Math.floor(maxCanvasWidth * scale);
      const height = Math.floor(maxCanvasHeight * scale);

      canvas.style.width = width + "px";
      canvas.style.height = height + "px";

      // 캔버스 실제 픽셀 해상도 설정
      canvas.width = width * window.devicePixelRatio;
      canvas.height = height * window.devicePixelRatio;

      // Unity에 사이즈 전달
      if (unityInstance) {
        let sizeData = JSON.stringify({ x: canvas.width, y: canvas.height });
        unityInstance.SendMessage("WebGLInterop", "UpdateGameResolution", sizeData);
      }
    }

    window.addEventListener("resize", resizePage);
    window.addEventListener("load", resizePage);

    createUnityInstance(document.querySelector("#unity-canvas"), {
      arguments: [],
      dataUrl: "Build/Build.data",
      frameworkUrl: "Build/Build.framework.js",
      codeUrl: "Build/Build.wasm",
      streamingAssetsUrl: "StreamingAssets",
      companyName: "mafia",
      productName: "Snowball Fight",
      productVersion: "1.0",
      matchWebGLToCanvasSize: false
    }).then(instance => {
      unityInstance = instance;
      resizePage();
    });
  </script>
</body>
</html>
